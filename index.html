<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Match Stats & Momentum</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">

  <style>
    html, body {
      overflow: hidden; /* Hides scrollbars */
      height: 100vh; /* Ensures full viewport height */
      margin: 0;
      padding: 0;
    }

    /* 1) Stats Chart: largest */
    #statsCanvas {
      display: block;
      width: 90vw;
      max-width: 900px;
      height: 600px; /* Bigger for multiple bars */
      margin: 20px auto;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    }

    /* 2) Momentum Chart */
    #momentumCanvas {
      display: block;
      width: 90vw;
      max-width: 900px;
      height: 500px; /* Medium size */
      margin: 20px auto;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    }

    /* 3) Possession Chart: Smallest */
    #possessionCanvas {
      display: block;
      width: 80vw;
      max-width: 400px; /* Smallest size */
      height: auto; /* Auto height for radial */
      margin: 20px auto;
      background: #fff;
      border-radius: 50%;
      box-shadow: 0 1px 4px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>

  <!-- 1) Stats Chart -->
  <canvas id="statsCanvas"></canvas>

  <!-- 2) Momentum Chart -->
  <canvas id="momentumCanvas"></canvas>

  <!-- 3) Possession Chart (Doughnut) -->
  <canvas id="possessionCanvas"></canvas>

  <script>
    /*************************************************************
     * 1) GLOBAL COLORS
     *************************************************************/
    const HOME_COLOR = "#fa3048"; // Red for Home
    const AWAY_COLOR = "#2c2c2c"; // Dark Gray for Away

    /*************************************************************
     * 2) PARSE URL PARAMS (NO PLACEHOLDERS)
     *************************************************************/
    const params = new URLSearchParams(window.location.search);

    // Possession
    const possessionHome = Number(params.get("possessionHome") || 50);
    const possessionAway = Number(params.get("possessionAway") || 50);

    // Stats (Shots, Fouls, etc.)
    const homeStats = [
      Number(params.get("home_shots") || 0),
      Number(params.get("home_shots_on_goal") || 0),
      Number(params.get("home_goal_chances") || 0),
      Number(params.get("home_duels_won") || 0),
      Number(params.get("home_saves") || 0),
      Number(params.get("home_corners") || 0),
      Number(params.get("home_fouls") || 0),
      Number(params.get("home_yellows") || 0),
      Number(params.get("home_reds") || 0)
    ];

    const awayStats = [
      Number(params.get("away_shots") || 0),
      Number(params.get("away_shots_on_goal") || 0),
      Number(params.get("away_goal_chances") || 0),
      Number(params.get("away_duels_won") || 0),
      Number(params.get("away_saves") || 0),
      Number(params.get("away_corners") || 0),
      Number(params.get("away_fouls") || 0),
      Number(params.get("away_yellows") || 0),
      Number(params.get("away_reds") || 0)
    ];

    const statLabels = [
      "Shots", "Shots on Goal", "Goal Chances", "Duels Won",
      "Saves", "Corners", "Fouls", "Yellows", "Reds"
    ];

    // Momentum
    const rawTimeTracker = params.get("time_tracker") || "0,15,30,45,60,75,90";
    const rawMomentum = params.get("momentum_tracker") || "0.5,0.55,0.6,0.55,0.4,0.7,0.6";
    const timeData = rawTimeTracker.split(",").map(x => Number(x.trim()));
    const homeMomentumData = rawMomentum.split(",").map(x => Number(x.trim()));
    const awayMomentumData = homeMomentumData.map(v => 1 - v);

    /*************************************************************
     * 3) CREATE STATS CHART
     *************************************************************/
    new Chart(document.getElementById("statsCanvas").getContext("2d"), {
      type: "bar",
      data: {
        labels: statLabels,
        datasets: [
          { label: "Home", data: homeStats, backgroundColor: HOME_COLOR, borderRadius: 6 },
          { label: "Away", data: awayStats, backgroundColor: AWAY_COLOR, borderRadius: 6 }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        indexAxis: "y",
        plugins: {
          title: { display: true, text: "Stats", font: { family: "Inter", weight: "700", size: 16 } },
          legend: { position: "top", labels: { font: { family: 'Inter', weight: '700' } } }
        },
        elements: { bar: { barPercentage: 0.7, categoryPercentage: 0.8 } },
        scales: { x: { beginAtZero: true }, y: { grid: { display: false } } }
      }
    });

    /*************************************************************
     * 4) CREATE MOMENTUM CHART
     *************************************************************/
    new Chart(document.getElementById("momentumCanvas").getContext("2d"), {
      type: "line",
      data: {
        labels: timeData,
        datasets: [
          { label: "Home Momentum", data: homeMomentumData, borderColor: HOME_COLOR, borderWidth: 3, radius: 0 },
          { label: "Away Momentum", data: awayMomentumData, borderColor: AWAY_COLOR, borderWidth: 3, radius: 0 }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        scales: {
          x: { type: "linear", title: { display: true, text: "Time (minutes)" } },
          y: { min: 0, max: 1.2, title: { display: true, text: "Momentum" } }
        },
        plugins: { legend: { position: "top" } },
        interaction: { mode: "index", intersect: false }
      }
    });

    /*************************************************************
     * 5) CREATE POSSESSION CHART (DOUGHNUT STYLE)
     *************************************************************/
    new Chart(document.getElementById("possessionCanvas").getContext("2d"), {
      type: "doughnut",
      data: {
        labels: ["Home", "Away"],
        datasets: [{ data: [possessionHome, possessionAway], backgroundColor: [HOME_COLOR, AWAY_COLOR] }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: true,
        plugins: {
          title: { display: true, text: "Ball Possession", font: { family: "Inter", weight: "700", size: 16 } },
          legend: { position: "bottom" }
        }
      }
    });
  </script>
</body>
</html>
